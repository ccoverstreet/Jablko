<!DOCTYPE html>
<html>
	<head>
		<title>Jablko</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="/assets/standard.css"></link>
		<style>
#mod-holder {
	columns: 3 20em;
	column-gap: 0px;
}
#mod-holder > * {
	display: inline-block;
	width: calc(100% - 6px);
	padding: 3px;
}
		</style>
		<script> 
			var jablkoWebCompMap = {} // Stores WebComponent source for each module
			var jablkoInstanceConfMap = {} // Holds configs for each module used for init
			var jablkoInstanceMap = {} // Holds initialized DOM elements for instances

			$JABLKO_WEB_COMPONENT_MAP_DEF
			$JABLKO_JMOD_INSTANCE_CONF_MAP_DEF

			document.addEventListener("DOMContentLoaded", function() {
				const dashboardButton = document.getElementById("button-goto-dashboard");
				dashboardButton.style.backgroundColor = "var(--clr-green)";

				var mod_holder = document.getElementById("mod-holder");

				let sortedMods = Object.keys(jablkoInstanceConfMap).sort()
				for (var source of sortedMods) {
					console.log(source);
					compname = source.split("@")[0];
					if (source[0] === "/") {
						compname = source.slice(1);
					}
					var name = compname.replaceAll("/", "-").replaceAll("_", "-").toLowerCase();
					customElements.define(name, jablkoWebCompMap[source]);

					for (const instName in jablkoInstanceConfMap[source]) {
						var elem = document.createElement(name);
						try {
							elem.init(source, jablkoInstanceConfMap[source][instName]);
							mod_holder.appendChild(elem);
							jablkoInstanceMap[String(window.performance.now())] = elem;
						} catch(err) {
							console.error(err);
						}

					}
				}
			})
		</script>
	</head>
	$JABLKO_TASKBAR
	<body>
		<div id="mod-holder">

		</div>
	</body>
</html>
<!-- Phil for all -->
<!-- "My logic would be correct if I made the right assumptions" - Big Brain -->
