<!DOCTYPE html>
<html>
	<head>
		<script>
			"use strict";

			const initData = [
				{mod: "peoplemaker-1.0.0", config: {id: "id1", age: 24}},
				{mod: "peoplemaker-1.0.0", config: {id: "id2", age: 20}},
				{mod: "peoplemaker-1.0.0", config: {id: "id3", age: 21}},
				{mod: "peoplemaker-1.0.0", config: {id: "id4", age: 23}},
				{mod: "peoplemaker-1.0.0", config: {id: "id5", age: 22}}
			];

			var mods = {};

			const sourceMap = {
				["peoplemaker-1.0.0"]: function(mod, config) {
					this.id = config.id;
					this.age = config.age;
					this.born = new Date().getTime();


					this.speak = function() {
						console.log(this);
						console.log(`I am ${this.age}`);
						document.getElementById(`${this.id}_speechbox`).textContent = this.age.toString() + " years old";
					}.bind(this)

					this.card = function() {
						return `
						<div style="display:inline-block; width: 100%;">
							<h1>Module ${this.id}</h1>
							<p id="${this.id}_speechbox"></p>
							<button onclick="mods['${this.id}'].speak();">TEST</button>
						</div>
						`
					}.bind(this)

					setInterval(this.speak, this.age * 100);
				}
			}

			window.addEventListener("DOMContentLoaded", function() {
				var modHolder = document.getElementById("module_holder");

				for (var i = 0; i < initData.length; i++) {
					mods[initData[i].config.id] = new sourceMap[initData[i].mod](initData[i].mod, initData[i].config);
					modHolder.insertAdjacentHTML("beforeend", mods[initData[i].config.id].card());
				}

				console.log(mods);
			})
		</script>
	</head>
	<body>
		<h1>Test of object-like frontend</h1>
		<div id="module_holder" style="columns: 3 300px;"></div>
	</body>
</html>
